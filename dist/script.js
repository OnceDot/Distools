!function(){"use strict";function e(e){return new Promise(t=>setTimeout(t,e))}const t={getByProps(...e){return this.getModule(t=>e.every(e=>t[e]))},getByValue(e,t){return this.getModule(n=>n[e]==t,!0)},getModule(e,t=!1){let n=this.getModules();for(let s in n){let{exports:r}=n[s];if(r){if(r.__esModule&&r.default&&e(r.default))return t?r:r.default;if(e(r))return r}}},getModules(){let e="webpackmodules";return this._require||(this._require="function"==typeof window.webpackJsonp?window.webpackJsonp([],{[e]:(e,t,n)=>t.default=n},[e]).default:window.webpackJsonp.push([[],{[e]:(e,t,n)=>e.exports=n},[[e]]]).c,delete this._require[e]),this._require}},n=t.getByProps("createElement","cloneElement"),s=t.getByProps("render","findDOMNode"),r=t.getByProps("getAPIBaseURL"),o=t.getByProps("Permissions","ActivityTypes","StatusTypes"),a=t.getByProps("getCurrentUser"),i=t.getByProps("getMember"),l=t.getByProps("getChannels"),d=t.getByProps("getMessages"),c=t.getByProps("getLastSelectedGuildId"),g=t.getByProps("getLastSelectedChannelId"),u=t.getByProps("receiveMessage","sendBotMessage");var h=Object.freeze({__proto__:null,sleep:e,WebpackModules:t,React:n,ReactDOM:s,DiscordAPI:r,DiscordConstants:o,DiscordUser:a,DiscordMembers:i,DiscordChannels:l,DiscordMessages:d,SelectedGuildId:c,SelectedChannelId:g,DiscordReceiveMessages:u});console.log(h);const p=document.createElement("style");p.innerText=":root {\n    --background-tertiary: #060606;\n    --background-floating: #0c0c0c;\n    --background-primary: #000;\n    --background-secondary: #0c0c0c;\n    --background-secondary-alt: #080808;\n    --channeltextarea-background: #0c0c0c;\n    --background-modifier-selected: #060606;\n    --interactive-muted: #0c0c0c;\n    --channels-default: #00ff72;\n    --text-normal: #00ff72;\n    --text-link: #00bd48;\n    --custom-background: #1fb940;\n    --custom-background-hover: #1eac3d;\n}\n\n.form-2fGMdU:before {\n    background: 0 !important;\n}\n\n.scroller-2FKFPG::-webkit-scrollbar-thumb {\n    background-color: var(--background-secondary) !important;\n    border-color: 0 !important;\n}\n\n.scroller-2FKFPG::-webkit-scrollbar-track-piece {\n    background: 0 !important;\n    border: 0 !important;\n}\n\n.wrapper-3WhCwL {\n    background: #43ff521a !important;\n    color: var(--text-normal) !important;\n}\n\n.headerNormal-T_seeN {\n    background-color: var(--background-tertiary) !important;\n}\n\n.root-1gCeng,\n.body-3iLsc4, .footer-1fjuF6, .inset-3sAvek {\n    background-color: var(--background-secondary) !important;\n}\n\n.footer-2gL1pp,\n.container-1D34oG  {\n    background-color: var(--background-primary) !important;\n}\n\n.input-cIJ7To.focused-1mmYsC, .input-cIJ7To:focus {\n    border-color: var(--text-normal) !important;\n}\n\n.newMessagesBar-mujexs {\n    background-color: var(--text-link) !important;\n}\n\n.avatarUploaderInner-3UNxY3,\n.barFill-23-gu-,\n.valueChecked-m-4IJZ,\n.lookFilled-1Gx00P.colorBrand-3pXr91,\n.wrapper-1BJsBx.selected-bZ3Lue .childWrapper-anI2G9, .wrapper-1BJsBx:hover .childWrapper-anI2G9,\n.headerPlaying-j0WQBV, .topSectionPlaying-1J5E4n {\n    background: var(--custom-background) !important;\n}\n\n.lookFilled-1Gx00P.colorBrand-3pXr91:hover,\n.interactive:hover {\n    background-color: var(--custom-background-hover) !important;\n}\n\n.root-1gCeng,\n.userPopout-3XzG_A {\n    -webkit-box-shadow: 0 2px 10px 0 rgba(0,0,0,.2), 0 0 0 1px rgba(0, 0, 0, 0.6) !important;\n    box-shadow: 0 2px 10px 0 rgba(0,0,0,.2), 0 0 0 1px rgba(0, 0, 0, 0.6) !important;\n}\n",document.head.append(p);var m={async searchSharedFriends(e){var t=this.members,n=[];for(var s of t){if(!s.relationships){var a=await r.get(o.Endpoints.USER_RELATIONSHIPS(s.userId));s.relationships=JSON.parse(a.text)}s.relationships.length&&n.push(s)}if(e){var i=[];for(var s of n)s.relationships.find(t=>t.id===e)&&i.push(s);n=i}return n},searchOwnGuildMessages(e,t=this.user.id,n=0){return new Promise((s,a)=>{r.get(`${o.Endpoints.SEARCH_GUILD(e)}?author_id=${t}&include_nsfw=true&offset=${n}`).then(e=>s(e.body)).catch(a)})},searchOwnChannelMessages(e,t=this.user.id,n=0){return new Promise((s,a)=>{r.get(`${o.Endpoints.SEARCH_CHANNEL(e)}?author_id=${t}&offset=${n}`).then(e=>s(e.body)).catch(a)})},async deleteOwnGuildMessages(){var t=this.selectedGuildId,n=await this.searchOwnGuildMessages(t),s=0;if(n)if(n.total_results>0){this.progressBar.setSteps(n.total_results);do{for(var r of(console.log(n.total_results+" remaining messages."),await e(200),n.messages)){for(var o of r)o.hit&&!o.call&&(await this.deleteMessage(o.channel_id,o.id),await e(200),s++);this.progressBar.setProgress(s)}}while((n=await this.searchOwnGuildMessages(t))&&n.total_results>0);console.log("Done."),await e(2e3),this.progressBar.setProgress(0)}else console.log("No message to delete.");else console.log("Index is not ready, try again.")},async deleteOwnChannelMessages(){var t=this.selectedChannelId,n=await this.searchOwnChannelMessages(t),s=0;if(n)if(n.total_results>0){this.progressBar.setSteps(n.total_results);do{for(var r of(console.log(n.total_results+" remaining messages."),await e(200),n.messages)){for(var o of r)o.hit&&!o.call&&(await this.deleteMessage(t,o.id),await e(200),s++);this.progressBar.setProgress(s)}}while((n=await this.searchOwnChannelMessages(t))&&n.messages.length>0);console.log("Done."),await e(2e3),this.progressBar.setProgress(0)}else console.log("No message to delete.");else console.log("Index is not ready, try again.")},async fetchAllMessages(e=this.selectedChannelId){var t=this.messages.reverse(),n=[];do{n.push(...t),t=(await r.get({url:o.Endpoints.MESSAGES(e),query:{before:t[t.length-1].id,limit:100}})).body}while(t.length>0);return n.reverse()},saveMessages(){alert("Starting downloading conversation.\nPlease do not click any buttons of the menu !"),this.fetchAllMessages().then(e=>{const t=this.members.map(e=>({id:e.id,username:e.username,discriminator:e.discriminator,avatar:e.avatar}));t.push(this.user),this.downloadTextFile(e[0].channel_id+".json",JSON.stringify({members:t,messages:e.map(e=>({id:e.id,author:e.author.id,content:e.content,timestamp:e.timestamp}))},null,2))})},downloadTextFile(e,t){var n=window.URL.createObjectURL(new Blob([t],{type:"octet/stream"})),s=document.createElement("a");s.href=n,s.download=e,s.style.display="none",document.body.prepend(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(n)},deleteMessage:(e,t)=>r.delete(`${o.Endpoints.MESSAGES(e)}/${t}`).then(e=>e.body),get receiveMessages(){return u},get members(){return this.SelectedGuildId?i.getMembers(this.selectedGuildId):l.getChannel(this.selectedChannelId).rawRecipients},get selectedGuildId(){return c.getGuildId()},get selectedChannelId(){return g.getChannelId()},get selectedChannel(){return l.getChannel(this.selectedChannelId)},get messages(){return d.getMessages(this.selectedChannelId).toArray()},get user(){return a.getCurrentUser()}};class f extends n.Component{constructor(e){super(e),this.node=n.createRef()}componentDidUpdate(){this.node.current&&window.requestAnimationFrame(()=>{var e=this.node.current.style;e.transform="translate(-50%, -50%) scale(1)",e.opacity="1"})}render(){return this.props.hide?null:n.createElement("div",{class:"modal",style:{opacity:0},ref:this.node},n.createElement("form",{class:"settings"},n.createElement("label",null,n.createElement("input",{type:"radio",value:"guild",checked:"true"}),"Current Guild"),n.createElement("label",null,n.createElement("input",{type:"radio",value:"channel"}),"Current Channel")))}}class b extends n.Component{constructor(e){super(e),this.progressBar=n.createRef(),this.steps=100}setSteps(e){this.steps=e}setProgress(e){this.progressBar.current.style.width=e/this.steps*100+"%"}render(){return n.createElement("div",{class:"progress-bar"},n.createElement("div",{class:"progress",ref:this.progressBar}))}}class w extends n.Component{constructor(e){super(e),this.state={hideSettings:!0},this.progressBar=n.createRef()}componentDidMount(){m.progressBar=this.progressBar.current}render(){return n.createElement(n.Fragment,null,n.createElement("style",null,"#distools * {\n    box-sizing: border-box;\n}\n\n#distools .right {\n    margin-left: auto;\n}\n\n#distools>nav {\n    background-color: #191818;\n    position: fixed;\n    left: 0;\n    bottom: 0;\n    display: flex;\n    height: 48px;\n    width: 100%;\n    padding: 0 4.5rem;\n    font-size: 0.85rem;\n    color: #fff;\n}\n\n#distools>nav>* {\n    display: flex;\n    align-items: center;\n}\n\n#distools>nav>.title {\n    margin-right: 1.5rem;\n    font-weight: bold;\n}\n\n#distools>nav>ul>li {\n    transition: background-color ease-in-out .2s;\n    display: flex;\n    align-items: center;\n    height: 100%;\n    padding: 0 1rem;\n    cursor: pointer;\n}\n\n#distools>nav>ul>li:hover {\n    background-color: #000;\n}\n\n/* PROGRESS BAR */\n.progress-bar {\n    background-color: #36393f;\n    position: absolute;\n    left: 0;\n    bottom: 0;\n    width: 100%;\n    height: 2px;\n}\n\n.progress {\n    transition: width ease-in-out .8s;\n    background-color: #2e70f3;\n    width: 0;\n    height: 2px;\n}\n\n/* MODAL */\n.modal {\n    transition: ease-in-out .25s;\n    transition-property: transform, opacity;\n    transform: translate(-50%, -50%) scale(0.8);\n    opacity: 0;\n    background-color: #191818;\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    width: 500px;\n    height: 500px;\n    z-index: 1;\n    color: #fff;\n}"),n.createElement(f,{hide:this.state.hideSettings}),n.createElement("nav",null,n.createElement(b,{ref:this.progressBar}),n.createElement("div",{class:"title"},"DISTOOLS"),n.createElement("ul",null,n.createElement("li",{onClick:()=>m.deleteOwnGuildMessages()},"🗑️ Delete guild messages"),n.createElement("li",{onClick:()=>m.deleteOwnChannelMessages()},"🗑️ Delete channel messages"),n.createElement("li",{onClick:()=>m.saveMessages()},"💾 Save messages")),n.createElement("ul",{class:"right"},n.createElement("li",{onClick:()=>this.setState({hideSettings:!this.state.hideSettings})},"⚙️ Settings"))))}}document.getElementById("app-mount").style.height="calc(100vh - 48px)";var y=document.getElementById("distools");y&&y.remove(),(y=document.createElement("div")).id="distools",s.render(n.createElement(w,null),y),document.body.prepend(y),window.DISTOOLS=m}();
